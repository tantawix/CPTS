- الناس كلها دلوقتي بقت تستخدم الTLS عشان تencrypt اي sensitive data في الtransit بين جهازين بس ممكن misconfigured services او legacy system او ابلكيشن مش شغال HTTPS وبيكون بيستخدم بروتوكولات مش مشفره زي HTTP او SNMP ده ممكن يدينا ميزه كا attackers وبما ان البروتوكول مش متشفر يعني الكلام بيتنقل كا plain text واحنا ممكن نhunt for creds in network traffic
- فالسكشن ده هنتعلم ازاي نعمل كده باستخدام أداة Wireshark او Pcredz

|Unencrypted Protocol|Encrypted Counterpart|Description|
|---|---|---|
|`HTTP`|`HTTPS`|Used for transferring web pages and resources over the internet.|
|`FTP`|`FTPS/SFTP`|Used for transferring files between a client and a server.|
|`SNMP`|`SNMPv3 (with encryption)`|Used for monitoring and managing network devices like routers and switches.|
|`POP3`|`POP3S`|Retrieves emails from a mail server to a local client.|
|`IMAP`|`IMAPS`|Accesses and manages email messages directly on the mail server.|
|`SMTP`|`SMTPS`|Sends email messages from client to server or between mail servers.|
|`LDAP`|`LDAPS`|Queries and modifies directory services like user credentials and roles.|
|`RDP`|`RDP (with TLS)`|Provides remote desktop access to Windows systems.|
|`DNS (Traditional)`|`DNS over HTTPS (DoH)`|Resolves domain names into IP addresses.|
|`SMB`|`SMB over TLS (SMB 3.0)`|Shares files, printers, and other resources over a network.|
|`VNC`|`VNC with TLS/SSL`|Allows graphical remote control of another computer.|

---
## Wireshark
- الwireshark غنيه عن التعريف طبعا من الpacket analyzer tools وبتكون موجوده ف كل توزيعات اللينكس
- الwireshark فيها مميزات كتير في السيرش واللي بتخليك تسيرش علي حاجات معينه بس

|Wireshark filter|Description|
|---|---|
|`ip.addr == 56.48.210.13`|Filters packets with a specific IP address|
|`tcp.port == 80`|Filters packets by port (HTTP in this case).|
|`http`|Filters for HTTP traffic.|
|`dns`|Filters DNS traffic, which is useful to monitor domain name resolution.|
|`tcp.flags.syn == 1 && tcp.flags.ack == 0`|Filters SYN packets (used in TCP handshakes), useful for detecting scanning or connection attempts.|
|`icmp`|Filters ICMP packets (used for Ping), which can be useful for reconnaissance or network issues.|
|`http.request.method == "POST"`|Filters for HTTP POST requests. In the case that POST requests are sent over unencrypted HTTP, it may be the case that passwords or other sensitive information is contained within.|
|`tcp.stream eq 53`|Filters for a specific TCP stream. Helps track a conversation between two hosts.|
|`eth.addr == 00:11:22:33:44:55`|Filters packets from/to a specific MAC address.|
|`ip.src == 192.168.24.3 && ip.dst == 56.48.210.3`|Filters traffic between two specific IP addresses. Helps track communication between specific hosts.|
![](Pasted%20image%2020260221061333.png)
ممكن تسيرش علي كلمة معينه مثلا زي `http contains "passw"` 

---
## Pcredz
- الPcredz دي تول بتستخدم عشان تextract creds من live traffic او network packet captures وهي بتدور علي حاجات زي
-Credit card numbers
-POP credentials
-SMTP credentials
-IMAP credentials
-SNMP community strings
-FTP credentials
-Credentials from HTTP NTLM/Basic headers, as well as HTTP Forms
-NTLMv1/v2 hashes from various traffic including DCE-RPC, SMBv1/2, LDAP, MSSQL, and HTTP
-Kerberos (AS-REQ Pre-Auth etype 23) hashes

```shell-session
0xTroj6n@htb[/htb]$ ./Pcredz -f demo.pcapng -t -v

Pcredz 2.0.2
Author: Laurent Gaffie
Please send bugs/comments/pcaps to: laurent.gaffie@gmail.com
This script will extract NTLM (HTTP,LDAP,SMB,MSSQL,RPC, etc), Kerberos,
FTP, HTTP Basic and credit card data from a given pcap file or from a live interface.

CC number scanning activated

Unknown format, trying TCPDump format

[1746131482.601354] protocol: udp 192.168.31.211:59022 > 192.168.31.238:161
Found SNMPv2 Community string: s3cr...SNIP...

[1746131482.601640] protocol: udp 192.168.31.211:59022 > 192.168.31.238:161
Found SNMPv2 Community string: s3cr...SNIP...

<SNIP>

[1746131482.658938] protocol: tcp 192.168.31.243:55707 > 192.168.31.211:21
FTP User: le...SNIP...
FTP Pass: qw...SNIP...

demo.pcapng parsed in: 1.82 seconds (File size 15.5 Mo).
```
---
